## Projecting data into the factorized latent space

#' project_W
#' 
#'  Function for predicting categorical labels in test data
#'
#' @useDynLib GRACKLE
#' @import nnls
#' @param test_expression Data.frame of test expression data
#' @param H_train Data.frame of trained H matrix
#' @param k numerical value for the chosen k
#' @return W_test Dataframe of project W values for the test data
#' @export
project_W <- function(test_data,H_train,k) {
  # Initialize W_test
  W_test <- matrix(0, nrow=nrow(test_data), ncol=k)
  
  # Solve for W_test using NNLS
  for (i in 1:nrow(test_data)) {
    nnls_result <- nnls(t(H_train), test_data[i, ])
    W_test[i, ] <- coef(nnls_result)
  }
  
  return(W_test)
}
